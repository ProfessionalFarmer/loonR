#' Analyze if gene is correlated with drug sensitivity
#'
#' @param drug.sen.df Row is drug, Col is sample. Pls perform log transformation
#' @param gene.df Row is gene Col is sample
#' @param compare.method wilcox.test t.test
#'
#' @return
#' @export
#'
#' @examples
celline_drug_target_auc_analysis <- function(drug.sen.df=NULL, gene.df = NULL, compare.method = "wilcox.test"){


  warning("Before input the drug sensitivity value, pls filter NA. In the following analysis we will not consider NA samples")
  if(is.null(drug.sen.df)|is.null(gene.df)){
    stop("Pls set drug sensititivity data and gene expression data. E.g. from https://discover.nci.nih.gov/rsconnect/cellminercdb/")
  }

  library(dplyr)
  library(foreach)

  library(utils)
  pb <- utils::txtProgressBar(style = 3)

  cat("Start AUC analysis\n")
  gene.names = rownames(gene.df)

  gene.auc.analysis.res = foreach(drugName = rownames(drug.sen.df), .combine = rbind) %do% {

    drug.sensitivity = unclass(unlist(drug.sen.df[drugName,]))
    drug.sensitivity = drug.sensitivity[!is.na(drug.sensitivity)]

    cellline.available.names = names(drug.sensitivity)

    # if lower than median, it's sensitive
    # based on median, split into T/F group
    drug.sensitivity = drug.sensitivity < median(drug.sensitivity)

    drug.res = foreach(gene = rownames(gene.df), .combine = c ) %do% {
      gene.expr.values = unclass(unlist(gene.df[gene, cellline.available.names]))
      loonR::get.AUC(gene.expr.values, drug.sensitivity)
    }

    setTxtProgressBar(pb, match(drugName,rownames(drug.sen.df))/nrow(drug.sen.df))

    drug.res = c(drugName, round(drug.res,3) )
    names(drug.res) = c("Drug",gene.names)
    drug.res

  }
  gene.auc.analysis.res = data.frame(gene.auc.analysis.res, check.names = F)
  rownames(gene.auc.analysis.res) = gene.auc.analysis.res$Drug
  gene.auc.analysis.res = gene.auc.analysis.res[,-c(1)]

  #####################################

  cat("Start significance analysis\n")


  gene.sig.analysis.res = foreach(drugName = rownames(drug.sen.df), .combine = rbind) %do% {

    drug.sensitivity = unclass(unlist(drug.sensitivity.df[drugName,]))
    drug.sensitivity = drug.sensitivity[!is.na(drug.sensitivity)]

    cellline.available.names = names(drug.sensitivity)

    drug.sensitivity = drug.sensitivity < median(drug.sensitivity)

    tmp.gene.exp = gene.df[,cellline.available.names]

    if(startsWith(compare.method,"wilco")){
      diff.res = loonR::MannWhitneyU_WilcoxonRankSumTest_differential(tmp.gene.exp, drug.sensitivity, cores = 1, cal.AUC = F)
    }else if(startsWith(compare.method,"t.te")){
      diff.res = loonR::ttest_differential(tmp.gene.exp, drug.sensitivity, cores = 1, cal.AUC = F)
    }

    setTxtProgressBar(pb, match(drugName,rownames(drug.sen.df))/nrow(drug.sen.df))

    diff.res = diff.res[gene.names,]

    drug.res = c(drugName, diff.res$P)
    names(drug.res) = c("Drug",gene.names)
    drug.res

  }
  close(pb)

  gene.sig.analysis.res = data.frame(gene.sig.analysis.res, check.names = F)
  rownames(gene.sig.analysis.res) = gene.sig.analysis.res$Drug
  gene.sig.analysis.res = gene.sig.analysis.res[rownames(gene.auc.analysis.res),-c(1)]


  # numeric
  gene.sig.analysis.res = loonR::convertDfToNumeric(gene.sig.analysis.res)
  gene.auc.analysis.res = loonR::convertDfToNumeric(gene.auc.analysis.res)


  # merge two table
  a = gene.auc.analysis.res
  a$Name = rownames(gene.auc.analysis.res)
  a= reshape2::melt(a, value.name = "AUC")


  b = gene.sig.analysis.res
  b$Name = rownames(gene.sig.analysis.res)
  b = reshape2::melt(b, value.name = "P")

  merged.table = dplyr::full_join(a,b, by=c("Name"="Name","variable"="variable"))
  rm(a, b)
  merged.table$BH.adj.P = p.adjust(merged.table$P, method = "BH")


  colnames(merged.table)[1:2] = c("Drug","Gene")
  split.byDrug = plyr::dlply(merged.table, "Drug", identity)


  drug.annotation.20220409 = data.frame(
    stringsAsFactors = FALSE,
    NAME = c("ML311","zebularine", "BRD-A02303741","importazole", "SR8278","elocalcitol", "BRD-A05715709","docetaxel", "cyclophosphamide","3-Cl-AHPC", "nutlin-3","NVP-231", "triptolide","avicin D", "Bax channel blocker", "CCT036477","erastin", "cucurbitacin I","paclitaxel", "hyperforin","brefeldin A", "tigecycline","itraconazole", "dexamethasone","teniposide", "ML162","necrostatin-1", "SN-38","ciclosporin","TGX-221", "bleomycin A2","DNMDP", "968","fluvastatin","PX-12", "PD318088","COL-3", "YK 4-279","fumonisin B1", "ifosfamide","salermide", "BCL-LZH-4","isoevodiamine", "lovastatin","BRD-A71883111", "blebbistatin","myriocin", "IPR-456","NSC23766", "oligomycin A","ML258","ML050", "fulvestrant", "BRD-A86708339","CID-5951923","FQI-1", "thalidomide", "temozolomide","BRD-A94377914", "cyanoquinoline 11","RITA", "tubastatin A","ML239", "LRRK2-IN-1","pyrazolanthrone", "BRD-K01737880","ML210", "NVP-BSK805","olaparib", "panobinostat","BRD-K02251932", "parbendazole","BRD-K02492147", "QS-11","AT-406", "SU11274","HC-067047", "azacitidine","foretinib","Merck60", "BIBR-1532","BRD-K04800985", "BMS-270394", "GSK-3 inhibitor IX","CIL41", "triazolothiadiazine","BRD9647", "PDMP","LE-135","GSK1059615", "narciclasine","AM-580", "AA-COCF3","GSK525762A", "temsirolimus","SID 26681509", "linsitinib","C6-ceramide", "BRD-K09344309","GANT-61", "KU 0060648", "BRD-K09587429","FGIN-1-27", "PRL-3 inhibitor I","dabrafenib", "avrainvillamide","GW-405833", "B02","SR-II-138A", "BRD-K11533227","PF-184","CIL56", "AT7867","NVP-BEZ235", "trametinib","TG-101348", "valdecoxib","procarbazine", "ciclopirox","BMS-754807", "BMS-345541","dinaciclib", "BRD-K13999467", "BRD-K14844214","R428","gemcitabine", "NVP-ADW742","PRIMA-1", "phloretin","obatoclax", "BRD-K16147474","CHIR-99021", "PLX-4720","regorafenib", "sotrastaurin","BRD-K17060750", "bendamustine","SCH-79797", "HLI 373","indisulam", "belinostat","staurosporine", "birinapant","MK-0752", "BRD-K19103580","gossypol", "prochlorperazine", "sitagliptin","SGX-523", "saracatinib","lapatinib", "erismodegib","MST-312","CIL70", "tamatinib","SKI-II","KW-2449", "RO4929097","simvastatin", "STF-31","BRD8899", "CR-1-31B","1S-3R-RSL-3", "sorafenib","piperlongumine", "SCH-529074","ETP-46464", "BRD-K24690302","FSC231", "fluorouracil","KU-55933", "OSI-930","CD-1530", "austocystin D","BRD-K26531177", "PD 153035","cytochalasin B", "BIX-01294","BRD-K27224038", "leptomycin B", "lomeguatrib","BRD-K27986637","TW-37", "AZD4547","brivanib", "BRD-K28456706","CD-437", "BRD-K29086754","BRD-K29313308", "PIK-93","chlorambucil", "NSC30930","axitinib", "KX2-391","BRD-K30019337", "Compound 1541A","BRD-K30748066", "VU0155056","ceranib-2", "VER-155008","AGK-2", "cytarabine hydrochloride", "BRD-K33199242","tivantinib", "BRD-K33514849", "isoliquiritigenin","clofarabine", "BRD-K34099515","cimetidine", "BRD-K34222889", "BRD-K34485477","BMS-536924","FQI-2", "dacarbazine", "BRD-K35604418","ouabain","BRD6340", "darinaparsin","niclosamide", "KU-60019","I-BET151", "StemRegenin 1","NPC-26", "BRD-K37390332","SB-525334", "PF-3758309","etoposide", "LY-2183240","nakiterpiosin", "ML031","NSC19630", "lenvatinib","NSC 74859", "BRD-K41334119","BRD-K41597374", "palmostatin B", "BRD-K42260513","sunitinib","myricetin", "SNS-032","MLN2480", "PF-4800567 hydrochloride", "WP1130","BRD-K44224150", "ML083","pandacostat","ELCPK", "betulinic acid", "BRD-K45681478","NSC48300","IU1", "BMS-195614","CIL55","Ki8751", "GMX-1778","Repligen 136", "SR1001","BRD-K48334597", "BRD-K48477130", "nintedanib","GSK2636771", "BRD-K49290616","dasatinib", "PRIMA-1-Met","abiraterone", "sildenafil","NVP-TAE684", "necrostatin-7","canertinib", "HBX-41108","BRD-K50799972", "BRD-K51490254", "cabozantinib","TPCA-1","CAY10576", "BRD-K51831558", "BRD-K52037352","cerulenin", "tacedinaline","methylstat","AZD7545", "GDC-0941","JW-55", "tivozanib","BEC","SRT-1720", "neuronal differentiation inducer III","ruxolitinib", "MK-1775","JQ-1", "WAY-362450","BYL-719", "BRD-K55116708","SZ4TA2","rigosertib", "isonicotinohydroxamic acid", "epigallocatechin-3-monogallate","topotecan", "MGCD-265","ABT-737","vemurafenib", "selumetinib", "marinopyrrole A","AT13387", "daporinad","AZD6482","AZ-3146", "DBeQ","tozasertib", "bardoxolone methyl","methotrexate", "mitomycin","ML029", "serdemetan","MG-132","PYR-41", "CAL-101","Mdivi-1", "BRD-K61166597","SB-225002", "CAY10594","Compound 7d-cis", "SB-743921","ABT-199", "neopeltolide","BRD1835", "BRD-K70511574","tipifarnib-P2", "ZSTK474","tipifarnib-P1", "BRD-K63431240", "barasertib","gefitinib", "necrosulfonamide","MI-1","apicidin", "BRD-K64610608", "tretinoin","Ko-143","TG-100-115", "PHA-793887","BI-2536", "semagacestat","AZD1480", "afatinib","KH-CB19", "BRD-K66453893","BRD-K66532283", "pifithrin-alpha", "Compound 23 citrate","SB-431542", "KU-0063794","GDC-0879", "pevonedistat","PI-103", "MK-2206","NSC95397","BRD8958", "alvocidib","tacrolimus", "ISOX","AZD8055","CIL55A", "ibrutinib","erlotinib", "ML312","masitinib","SNX-2112", "KPT185","Ch-55", "N9-isopropylolomoucine", "BRD-K71781559","BRD5468", "QW-BI-011","WZ4002","BRD1812", "purmorphamine","BIRB-796", "curcumin","UNC0321", "NSC632839","pazopanib", "BRD-K75293299","alisertib","XL765", "IC-87114","JW-74", "omacetaxine mepesuccinate", "YM-155","A-804598","EX-527", "vandetanib","entinostat", "LY-2157299","crizotinib", "BRD-K78574327", "manumycin A","MLN2238","GSK4112", "KHS101","PF-573228", "decitabine","PF-543", "BRD-K80183349","ML203","etomoxir", "vorinostat","silmitasertib", "tanespimycin","ML320", "nilotinib","parthenolide", "WZ8040","vincristine", "navitoclax","PF-750", "CAY10618","PL-DI","skepinone-L", "nelarabine","CBB-1007", "BRD-K84807411","sirolimus", "spautin-1", "BRD-K85133207","neratinib","AZD7762", "BRD-K86535717","BRD4132", "bafilomycin A1","UNC0638", "cediranib","OSI-027", "veliparib","L-685458", "momelotinib","istradefylline", "fingolimod","bortezomib", "CI-976","BRD-K88742110", "tandutinib","BRD9876", "RG-108","ML006", "trifluoperazine","BRD-K90370028", "GW-843682X","pitstop2", "bosutinib","MI-2", "O-6-benzylguanine","doxorubicin", "tosedostat","GSK461364", "bexarotene","imatinib", "BRD-K92856060","SMER-3","PAC-1", "SJ-172550","RAF265", "AC55649","ML334 diastereomer", "vorapaxar","tamoxifen", "quizartinib","CHM-1","BRD1378", "VAF-347","BRD-K96431673", "pifithrin-mu", "BRD-K96970199","BRD-K97651142", "GSK-J4", "16-beta-bromoandrosterone","pluripotin", "BRD-K99006945","JW-480", "linifanib","BRD-M00053801"),
    MOA = c("inhibitor of MCL1", "inhibitor of DNA methyltransferases", "inhibitor of histone methyltransferases", "inhibitor of importin", "antagonist of Rev-ErbAalpha", "agonist of vitamin D receptor", "putative inhibitor of IDH1 R132H", "inhibitor of microtubule assembly","DNA alkylator", "binder of nuclear receptor SHP", "inhibitor of p53-MDM2 interaction", "inhibitor of ceramide kinase", "natural product; inhibitor of RNA polymerase II", "natural product", "inhibitor of BAX-mediated mitochondrial cytochrome c release", "inhibitor of WNT signaling by blocking beta-catenin transcription", "modulator of voltage-dependent anion channels; inhibitor of solute carrier SLC7A11", "natural product; modulator of NFKB1 and STAT3 signaling", "inhibitor of microtubule assembly", "agonist of calcium-permeable ion channels", "modulator of ADP-ribosylation factor 1; inhibitor of protein translocation from ER to Golgi", "analog of tetracycline", "anti-fungal agent; inhibitor of hedgehog signaling pathway", "agonist of glucocorticoid receptor", "inhibitor of topoisomerase II", "selectively kills engineered cells expressing mutant HRAS", "inhibitor of receptor-interacting protein kinase 1; inhibitor of the necroptosis cell death pathway", "metabolite of irinotecan; inhibitor of topoisomerase I", "inhibitor of calcineurin by binding to cyclophilin D", "inhibitor of PI3K catalytic subunit beta", "inducer of DNA damage", "screening hit", "inhibitor of glutaminase", "inhibitor of HMG-CoA reductase", "inhibitor of thioredoxin-1", "inhibitor of MEK1 and MEK2", "analog of tetracycline", "inhibitor of RNA helicase A (RHA) binding to EWS-FLI1; inhibitor of ERG and ETV1 activity", "inhibitor of ceramide synthase", "DNA alkylator", "inhibitor of sirtuin 1 and sirtuin 2", "\\inhibitor of BCL2, BCL-xL, and MCL1\\\"\"", "natural product", "inhibitor of HMG-CoA reductase", "putative inhibitor of IDH1 R132H", "inhibitor of myosin II ATPases", "inhibitor of serine palmitoyltransferase", "inhibitor of the interaction of urokinase receptor with binding partners", "inhibitor of RAC1-GEF interaction; prevents Rac1 activation by Rac-specific guanine nucleotide exchange factors (GEFs) TrioN and Tiam1", "inhibitor of mitochondrial ATP synthase", "inhibitor of BIM-BCL-B interaction","antagonist of GPR30", "antagonist of the estrogen receptor","screening hit", "modulator of KLF5 expression", "inhibitor of LSF1-mediated transcription", "immunomodulatory drug; binder of cereblon","DNA alkylator", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of MAP3K8; inhibitor of phosphorylated EGFR in cells", "inhibitor of p53-MDM2 interaction", "inhibitor of tubulin deacetylase activity of HDAC6", "ML239; inhibitor of breast cancer stem cell proliferation", "inhibitor of leucine-rich repeat kinase 2; inhibitor of doublecortin-like kinase", "inhibitor of Jun N-terminal kinase (JNK) 1/2/3", "screening hit", "selectively kills engineered cells expressing mutant HRAS", "inhibitor of Janus kinase 2", "inhibitor of poly (ADP-ribose) polymerase 1 and 2", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "product of diversity oriented synthesis", "inhibitor of microtubule assembly", "product of diversity oriented synthesis", "inhibitor of GTPase activating protein of ARF 1 (ARFGAP1)", "SMAC mimetic; inhibitor of inhibitor of apoptosis proteins (IAPs)", "inhibitor of MET", "inhibitor of cation channel TRPV4", "inhibitor of DNA methyltransferase", "inhibitor of MET and VEGFR2", "inhibitor of HDAC1 and HDAC2", "inhibitor of telomerase reverse transcriptase", "product of diversity oriented synthesis", "antagonist of retinoic acid receptor gamma", "inhibitor of JAK/STAT signaling", "screening hit", "inhibitor of phosphdiesterase 4A/B/D", "screening hit", "inhibitor of ceramide glucosyltransferase", "antagonist of retinoic acid receptor beta", "inhibitor of PI3K and mTOR kinase activity", "activates cellular activity of RhoA; modulator of Rho/Rho kinase/LIM kinase/cofilin signaling", "agonist of retinoic acid receptor alpha", "inhibitor of cytosolic phospholipase A2; inhibitor of fatty acid amide hydrolase", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "inhibitor of mTOR", "inhibitor of cathepsin L", "inhibitor of insulin-like growth factor 1 receptor and insulin receptor", "inhibitor of glucosylceramide synthase; activator of MAP kinase (ERK); stimulator of protein phosphatase 2A","screening hit", "inhibitor of hedgehog signaling pathway", "inhibitor of DNA-dependent protein kinase", "product of diversity oriented synthesis", "activator of peripheral benzodiazepine receptor/translocator protein", "inhibitor of phosphatase of regenerating liver-3 (PRL3)","inhibitor of BRAF", "natural product; inhibitor of nucleophosmin", "partial agonist of cannabinoid receptor 2","inhibitor of RAD51", "silvestrol analog; inhibits translation by modulating the eIF4F complex", "inhibitor of HDAC1 and HDAC2", "inhibitor of IKK-2", "screening hit", "inhibitor of AKT1/2/3 and S6K", "inhibitor of PI3K and mTOR kinase activity", "inhibitor of MEK1 and MEK2", "inhibitor of Janus kinase 2", "inhibitor of cyclooxygenase-2 (COX2)", "inducer of DNA damage", "substituted pyridone antimycotic; inhibitor of the iron-dependent enzyme ribonucleotide reductase", "inhibitor of insulin-like growth factor 1 receptor and insulin receptor", "inhibitor of IKK-2", "inhibitor of cyclin-dependent kinases", "product of diversity oriented synthesis", "product of diversity oriented synthesis", "inhibitor of the tyrosine-protein kinase receptor UFO", "\\inhibitor of DNA replication; inhibitor of ribonucleotide reductase, thymidylate synthetase, and cytidine monophosphate (UMP-CMP) kinase \\\"\"", "inhibitor of insulin-like growth factor 1 receptor", "re-activator of the pro-apoptotic activity of mutant p53", "natural product; inhibitor of glucose uptake", "\\inhibitor of MCL1, BCL2, and BCL-xL\\\"\"", "product of diversity oriented synthesis", "inhibitor of GSK3 beta", "inhibitor of BRAF", "\\inhibitor of BRAF, RET, KIT, and VEGFR2\\\"\"", "inhibitor of protein kinase C beta", "product of diversity oriented synthesis", "DNA alkylator", "antagonist of proteinase-activated receptor 1 (PAR1)", "inhibitor of MDM2", "inhibitor of carbonic anhydrase isoform IX", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of multiple kinases", "SMAC mimetic; inhibitor of inhibitor of apoptosis proteins (IAPs)", "inhibitor of gamma-secretase", "product of diversity oriented synthesis", "inhibitor of lactate dehydrogenase; inhibitor of BCL2 family members", "inhibitor of dopamine receptor D2", "inhibitor of dipetidyl peptidase-4", "inhibitor of MET", "inhibitor of SRC and ABL1", "inhibitor of EGFR and HER2", "screening hit", "inhibitor of telomerase reverse transcriptase", "screening hit", "inhibitor of spleen tyrosine kinase", "inhibitor of sphingosine kinase 1", "inhibitor of FLT3 and AURKA", "inhibitor of gamma-secretase", "inhibitor of HMG-CoA reductase", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of serine/threonine kinasase STK33", "silvestrol analog; inhibits translation by modulating the eIF4F complex", "synthetic lethal with HRAS in engineered cells; inhibitor of GPX4", "\\inhibitor of BRAF, CRAF, and VEGFR2\\\"\"", "natural product; modulator of ROS levels", "activator of mutant p53", "inhibitor of serine/threonine-protein kinase ATR", "inhibitor of HDAC1", "inhibitor of PDZ domain of protein interacting with PRKCA 1 (PICK1)", "pyrimidine analog; inhibitor of thymidylate synthase", "inhibitor of ataxia telangiectasia mutated (ATM)", "inhibitor of c-KIT and VEGFR2", "agonist of retinoic acid receptor gamma", "natural product; inducer of DNA damage", "analog of the natural product piperlongumine", "inhibitor of EGFR", "inhibitor of actin polymerization", "inhibitor of G9a histone methyltransferase", "product of diversity oriented synthesis", "inhibitor of exportin 1", "inhibitor of methylguanine-DNA methyltransferase", "product of diversity oriented synthesis; screening hit", "inhibitor of BCL2 and BCL-xL", "inhibitor of fibroblast growth factor receptors", "inhibitor of VEGFR 1/2", "inhibitor of hepatocyte nuclear factor 4 alpha", "agonist of retinoic acid receptor gamma", "product of diversity oriented synthesis", "inhibitor of HDAC3", "inhibitor of PI3K catalytic subunit gamma", "DNA alkylator", "inhibitor of steroid 5-alpha reductase", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "peptide mimetic; inhibitor of SRC activity in cells", "product of diversity oriented synthesis", "\\activators of executioner procaspases 3, 6, and 7\\\"\"", "inhibitor of CDK9", "inhibitor of phospholipase D1/D2", "inhibitor of ceramidase activity", "inhibitor of HSP70","inhibitor of sirtuin 2", "inducer of DNA damage", "product of diversity oriented synthesis", "inhibitor of MET; inhibitor of microtubule assembly","screening hit", "natural product", "inducer of DNA damage", "screening hit", "inhibitor of histidine receptor H2", "analog of the natural product piperlongumine", "product of diversity oriented synthesis", "inhibitor of insulin-like growth factor 1 receptor (IGF1R) and insulin receptor (INSR)", "inhibitor of LSF1-mediated transcription", "DNA alkylator","inhibitor of MCL1", "cardiac glycoside; inhibitor of the Na+/K+-ATPase", "screening hit", "inducer of ROS; inhibitor of microtubule assembly", "inhibitor of STAT3 signaling", "inhibitor of ataxia telangiectasia mutated (ATM)", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "inhibitor of aryl hydrocarbon receptor", "\\induces cell death through a non-apoptotic, mitochondrial-dependent mechanism\\\"\"", "product of diversity oriented synthesis", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of serine/threonine p21-activating kinase 4", "inhibitor of topoisomerase II", "inhibitor of fatty acid amide hydrolase; inhibitor of anandamide uptake", "natural product; inhibitor of microtubule assembly", "inhibitor of sphingosine 1-phosphate receptor 2", "inhibitor of Werner syndrome helicase activity", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "inhibitor of STAT3", "product of diversity oriented synthesis", "product of diversity oriented synthesis", "inhibitor of acyl-protein thioesterase 1", "inhibitor of enhancer of zeste polycomb repressive complex 2 subunit", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "flavonoid antioxidant", "inhibitor of cyclin-dependent kinases", "inhibitor of RAF kinases", "inhibitor of casein kinase isoforms delta and epsilon", "\\inhibitor of the deubiquitinase activity of USP9X, USP5, USP14, and UCH37\\\"\"", "product of diversity oriented synthesis", "activator of muscle pyruvate kinase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"","screening hit", "natural product; inhibitor of specificity protein 1 transcription factor in cells", "product of diversity oriented synthesis; screening hit", "inhibitor of threonine endopeptidase taspase 1", "inhibitor of the deubiquitinase activity of USP14", "antagonist of retinoic acid receptors","screening hit", "\\inhibitor of VEGFR2, c-KIT, and PDGFRA\\\"\"", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of HDAC3", "synthetic ROR ligand; suppressor of TH17 differentiation", "product of diversity oriented synthesis", "screening hit", "\\inhibitor of c-KIT, VEGFRs, PDGFRs, and FGFRs\\\"\"", "inhibitor of PI3K catalytic subunit beta", "product of diversity oriented synthesis", "\\inhibitor of SRC, YES1, EPHA2, c-KIT, and LCK\\\"\"", "re-activator of the pro-apoptotic activity of mutant p53", "\\inhibitor of 17 alpha-hydroxylase and C17,20 lyase\\\"\"", "inhibitor of phosphodiesterase 5A", "inhibitor of ALK and ALK-NPM fusion protein", "inhibitor of necroptosis", "inhibitor of EGFR and HER2", "inhibitor of the deubiquitinase activity of USP7", "product of diversity oriented synthesis", "inhibitor of HDAC6 and HDAC8", "\\inhibitor of c-MET, VEGFR2/3, and RET\\\"\"", "inhibitor of IKK-2", "inhibitor of IKK-epsilon", "inhibitor of enhancer of zeste polycomb repressive complex 2 subunit", "product of diversity oriented synthesis", "inhibitor of fatty acid synthase; inhibitor of HMG-CoA synthase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of lysine specific demethylases", "inhibitor of pyruvate dehydrogenase kinase 2", "inhibitor of PI3K kinase activity", "inhibitor of tankyrase", "inhibitor of VEGFRs", "inhibitor of arginase I and II", "activator of sirtuin-1", "induction of rat HCN cell differentiation as judged by induction of neuronal reporter neuroD activity", "inhibitor of Janus kinases 1 and 2", "inhibitor of WEE1", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "agonist of farnesoid X receptor", "inhibitor of PI3K catalytic subunit alpha", "product of diversity oriented synthesis; inhibitor of leukemic stem cells", "inhibitor of BCL-xL", "inhibitor of polo-like kinase 1; inhibitor of PI3K catalytic subunits alpha and beta", "inhibitor of HDAC6", "natural product", "inhibitor of topoisomerase I", "inhibitor of c-MET and VEGFRs", "\\inhibitor of BCL2, BCL-xL, and BCL-W\\\"\"","inhibitor of BRAF", "inhibitor of MEK1 and MEK2", "natural product; putative inhibitor of MCL1", "inhibitor of HSP90", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of PI3K catalytic subunits beta and delta", "inhibitor of TTK protein kinase", "inhibitor of p97 in cells", "inhibitor of aurora kinases", "electrophilic inducer of the NFE2L2-KEAP1 pathway", "inhibitor of dihydrofolate reductase","DNA crosslinker", "inhibitor of antigen receptor-mediated NFkappaB activity", "inhibitor of MDM2", "inhibitor of the proteosome", "inhibitor of ubiquitin-activating enzyme in cells", "inhibitor of PI3K catalytic subunit delta", "inhibitor of dynamin 1; inhibitor of mitrochondrial division inhibitor", "inhibitor of HDAC1 and HDAC2", "inhibitor of chemokine receptor 2", "inhibitor of phospholipase D2", "inhibitor of CRM1-mediated nucleocytoplasmic transport", "inhibitor of kinesin 11", "inhibitor of BCL2", "inhibitor of cellular respiration", "product of diversity oriented synthesis; screening hit", "inhibitor of polo-like kinase 1 (PLK1)", "inhibitor of farnesyltransferase", "\\inhibitor of PI3K catalytic subunits beta, delta, and gamma\\\"\"", "inhibitor of farnesyltransferase", "product of diversity oriented synthesis; screening hit", "inhibitor of aurora kinase B", "inhibitor of EGFR and AKT1", "inhibitor of downstream signaling of RIP3 associated with MLKL", "binder of menin; inhibitor of menin-MLL fusion protein", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "product of diversity oriented synthesis; screening hit", "agonist of retinoid acid receptors", "inhibitor of breast cancer resistance protein multidrug transporter (BCRP)", "inhibitor of PI3K catalytic subunits delta and gamma", "inhibitor of cyclin-dependent kinases", "inhibitor of polo-like kinase 1 (PLK1)", "inhibitor of gamma-secretase", "inhibitor of Janus kinases 1 and 2", "inhibitor of EGFR and HER2", "inhibitor of CDC2-like kinases 1 and 4", "product of diversity oriented synthesis", "inhibitor of HDAC1 and HDAC2", "inhibitor of p53-dependent signaling", "analog of natural product cortistatin", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of mTOR","inhibitor of BRAF", "inhibitor of Nedd-8 activating enzyme", "\\inhibitor of DNA-PK, PI3K p110 delta, mTORC1, and catalytic subunits of PI3K\\\"\"", "inhibitor of AKT1", "inhibitor of cell division cycle 25 phosphatase (CDC25)", "inhibitor of E1A binding protein p300", "inhibitor of cyclin-dependent kinases", "inhibitor of calcineurin", "inhibitor of HDAC6","inhibitor of mTOR", "screening hit", "inhibitor of Bruton's tyrosine kinase", "inhibitor of EGFR and HER2", "\\inhibitor of scavenger receptor class B, member 1 (SCARB1)-mediated lipid uptake\\\"\"", "\\inhibitor of c-KIT, PDGFRA, and PDGFRB\\\"\"", "inhibitor of HSP90alpha and HSP90beta", "inhibitor of exportin 1", "agonist of retinoid acid receptors", "inhibitor of CDK1/cyclin B and CDK5/p35 complexes", "screening hit", "inducer of ROS", "inhibitor of G9a histone methyltransferase", "inhibitor of EGFR targeting T790M resistance", "screening hit", "activator of smoothened receptor", "inhibitor of p38 MAPK", "natural product; modulator of ROS; modulator of NF-kappa-B signaling", "inhibitor of G9a histone methyltransferase", "inhibitor of ubiquitin isopeptidase", "\\inhibitor of VEGFRs, c-KIT, and PDGFRB\\\"\"", "product of diversity oriented synthesis", "inhibitor of aurora kinases A and B", "inhibitor of mTOR and PI3K kinase acitivities", "inhibitor of PI3K catalytic subunit delta", "inhibitor of WNT signaling", "inhibitor of protein translation by preventing protein elongation", "inhibitor of survivin expression", "inhibitor of purinergic receptor P2X", "inhibitor of sirtuin 1", "inhibitor of VEGFR2 and EGFR", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of c-MET and ALK", "product of diversity oriented synthesis", "inhibitor of RAS farnesyltransferase", "inhibitor of 20S proteasome at the chymotrypsin-like proteolytic (beta-5) site", "antagonist of Rev-ErbAalpha", "\\binder of TACC3, a component of the centrosome and mitotic spindle\\\"\"", "inhibitor of focal adhesion kinase", "inhibitor of DNA methyltransferase", "inhibitor of sphingosine kinase-1", "inhibitor of HDAC1 and HDAC2", "activator of muscle pyruvate kinase (PKM2)", "inhibitor of carnitine palmitoyltransferase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of casein kinase 2", "inhibitor of HSP90", "inhibitor of GSK3 beta", "\\inhibitor of ABL1, BCR, and c-KIT\\\"\"", "natural product; modulator of ROS; modulator of NF-kappa-B signaling", "inhibitor of EGFR targeting T790M resistance", "inhibitor of mictrotubule assembly", "\\inhibitor of BCL2, BCL-xL, and BCL-W\\\"\"", "inhibitor of fatty acid amide hydrolase", "inhibitor of nicotinamide phosphoribosyltransferase", "dimer of piperlongumine; inducer of ROS", "inhibitor of p38 MAPK", "deoxyguanosine analog; inhibitor of DNA synthesis", "inhibitor of lysine-specific demethylase 1A (LSD1)", "product of diversity oriented synthesis", "inhibitor of mTOR", "inhibitor of the deubiquitinase activity of USP13 and USP10", "inhibitor of HDAC1", "inhibitor of EGFR and HER2", "inhibitor of checkpoint kinases 1 and 2", "product of diversity oriented synthesis", "screening hit", "inhibitor of the vacuolar-type H+-ATPase", "inhibitor of EHMT2 and GLP methyltransferase", "inhibitor of VEGFRs", "inhibitor of mTORC1 and mTORC2", "inhibitor of poly (ADP-ribose) polymerase 1 (PARP1) and 2 (PARP2)", "inhibitor of gamma-secretase", "inhibitor of Janus kinases 1 and 2", "antagonist of the adenosine A2A receptor", "inhibitor of sphingosine 1-phosphate receptor", "inhibitor of 26S proteasome", "inhibitor of acetyl-CoA acetyltransferase I", "inhibitor of HDAC8", "inhibitor of c-KIT and VEGFR3", "screening hit", "inhibitor of DNA methyltransferase", "agonist of sphingosine 1-phosphate receptor 3", "antagonist of dopamine receptor D2", "screening hit", "inhibitor of PLK1 and PLK3", "inhibitor of clathrin and clathrin-independent endocytosis", "inhibitor of SRC and ABL1", "binder of menin; inhibitor of menin-MLL fusion protein", "inhibitor of O(6)-alkylguanine DNA alkyltransferases", "inhibitor of topoisomerase II", "\\inhibitor of leucine aminopeptidase 3 (LAP), puromycin-sensitive aminopeptidase (PuSA), and aminopeptidase N\\\"\"", "inhibitor of polo-like kinase 1 (PLK1)", "agonist of retinoid X receptors", "inhibitor of BCR-ABL1 and c-KIT", "screening hit", "inhibitor of E3-ubiquitin ligase", "activator of procaspase-3", "inhibitor of p53-MDM2 interaction", "ihibitor of VEGFR2 and BRAF", "agonist of retinoic acid receptor beta", "inhibitor of KEAP1-NFE2L2 protein-protein interaction", "antagonist of proteinase-activated receptor 1 (PAR1)", "modulator of estrogen receptors","inhibtor of VEGFR3", "inhibitor of tubulin polymerization","inducer of ROS", "inhibitor of aryl hydrocarbon receptor", "product of diversity oriented synthesis", "inhibitor of p53 binding to mitochondria; inhibitor of HSP70", "product of diversity oriented synthesis", "aphrocallistin derivative", "inhibitor of lysine-specific demethylases", "dehydroepiandrosterone (DHEA) analog", "promoter of embryonic stem cell self-renewal; inhibitor of Ras-GAP and ERK", "screening hit", "inhibitor of serine hydrolase enzyme NCEH", "inhibitor of VEGFRs", "inhibitor of BCL2"),
    CLINICAL.STATUS = c("Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Clinical trial","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "Clinical trial","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Clinical trial","Under investigation", "Clinical trial","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation", "Clinical trial","Under investigation", "FDA approved","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Clinical trial","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Clinical trial","Under investigation","Under investigation", "FDA approved", "Clinical trial","Under investigation","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation", "Clinical trial","Under investigation","FDA approved","Under investigation", "Under investigation","FDA approved", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Clinical trial", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation", "Clinical trial","FDA approved", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "FDA approved","Clinical trial","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation")  )

  merged.table = dplyr::left_join(merged.table, drug.annotation.20220409, by=c("Drug"="NAME"))

  res = list(
    AUC = gene.auc.analysis.res,
    Sig = gene.sig.analysis.res,
    Merged = merged.table,
    split.byDrug = split.byDrug
  )

 res
}


#' Analyze if a durg sensitivity is correlated with group/subtype
#'
#' @param drug.sen.df
#' @param group
#' @param compare.method Default wilcox.test
#' @param group.name Default Group
#'
#' @return
#' @export
#'
#' @examples
celline_drug_group_auc_analysis <- function(drug.sen.df=NULL, group = NULL, group.name = "Group", compare.method = "wilcox.test"){

  # 与前面的相反，前面是根据drug sensitivity 分成两组，用基因表达值来判断
  # 这俩是用drug sensitivity来判断group/subtype
  warning("Before input the drug sensitivity value, pls filter NA. In the following analysis we will not consider NA samples")
  if(is.null(drug.sen.df)|is.null(group)){
    stop("Pls set drug sensititivity data and group information (vector). E.g. from https://discover.nci.nih.gov/rsconnect/cellminercdb/")
  }

  library(dplyr)
  library(foreach)

  library(utils)
  pb <- utils::txtProgressBar(style = 3)

  cat("Start AUC analysis\n")

  drug.auc.analysis.res = foreach(drugName = rownames(drug.sen.df), .combine = rbind) %do% {

    drug.sensitivity = unclass(unlist(drug.sen.df[drugName,]))

    availabel.sample.ind = !is.na(drug.sensitivity)

    drug.sensitivity = drug.sensitivity[availabel.sample.ind]
    durg.group = group[availabel.sample.ind]

    # > for (controls > t >= cases)
    auc = loonR::get.AUC(drug.sensitivity, durg.group, raw = FALSE, direction = ">")

    setTxtProgressBar(pb, match(drugName,rownames(drug.sen.df))/nrow(drug.sen.df))

    drug.res = c(drugName, round(auc,3) )
    names(drug.res) = c("Drug", group.name)
    drug.res

  }
  drug.auc.analysis.res = data.frame(drug.auc.analysis.res, check.names = F)
  rownames(drug.auc.analysis.res) = drug.auc.analysis.res$Drug

  close(pb)

  #####################################

  cat("Start significance analysis\n")

  if(startsWith(compare.method,"wilco")){
    drug.sig.analysis.res = loonR::MannWhitneyU_WilcoxonRankSumTest_differential(drug.sen.df, group, cores = 1, cal.AUC = F)
  }else if(startsWith(compare.method,"t.te")){
    drug.sig.analysis.res = loonR::ttest_differential(drug.sen.df, group, cores = 1, cal.AUC = F)
  }

  # numeric
  drug.sig.analysis.res = loonR::convertDfToNumeric(drug.sig.analysis.res)
  warning("No worry. NA introduced because we try convert data.frame to numeric. We have solved.")
  drug.sig.analysis.res$Name = rownames(drug.sig.analysis.res)
  colnames(drug.sig.analysis.res)[1] = "Drug"


  drug.sig.analysis.res$P = formatC(drug.sig.analysis.res$P, digits = 2, format = 'e')
  drug.sig.analysis.res$`BH-Adjusted P` = formatC(drug.sig.analysis.res$`BH-Adjusted P`, digits = 2, format = 'e')
  drug.sig.analysis.res$Difference =  round(drug.sig.analysis.res$Difference, 3)
  drug.sig.analysis.res$Average = round(drug.sig.analysis.res$Average, 3)


  merged.table = dplyr::full_join(drug.sig.analysis.res, drug.auc.analysis.res, by=c("Drug"="Drug") )

  drug.annotation.20220409 = data.frame(
    stringsAsFactors = FALSE,
    NAME = c("ML311","zebularine", "BRD-A02303741","importazole", "SR8278","elocalcitol", "BRD-A05715709","docetaxel", "cyclophosphamide","3-Cl-AHPC", "nutlin-3","NVP-231", "triptolide","avicin D", "Bax channel blocker", "CCT036477","erastin", "cucurbitacin I","paclitaxel", "hyperforin","brefeldin A", "tigecycline","itraconazole", "dexamethasone","teniposide", "ML162","necrostatin-1", "SN-38","ciclosporin","TGX-221", "bleomycin A2","DNMDP", "968","fluvastatin","PX-12", "PD318088","COL-3", "YK 4-279","fumonisin B1", "ifosfamide","salermide", "BCL-LZH-4","isoevodiamine", "lovastatin","BRD-A71883111", "blebbistatin","myriocin", "IPR-456","NSC23766", "oligomycin A","ML258","ML050", "fulvestrant", "BRD-A86708339","CID-5951923","FQI-1", "thalidomide", "temozolomide","BRD-A94377914", "cyanoquinoline 11","RITA", "tubastatin A","ML239", "LRRK2-IN-1","pyrazolanthrone", "BRD-K01737880","ML210", "NVP-BSK805","olaparib", "panobinostat","BRD-K02251932", "parbendazole","BRD-K02492147", "QS-11","AT-406", "SU11274","HC-067047", "azacitidine","foretinib","Merck60", "BIBR-1532","BRD-K04800985", "BMS-270394", "GSK-3 inhibitor IX","CIL41", "triazolothiadiazine","BRD9647", "PDMP","LE-135","GSK1059615", "narciclasine","AM-580", "AA-COCF3","GSK525762A", "temsirolimus","SID 26681509", "linsitinib","C6-ceramide", "BRD-K09344309","GANT-61", "KU 0060648", "BRD-K09587429","FGIN-1-27", "PRL-3 inhibitor I","dabrafenib", "avrainvillamide","GW-405833", "B02","SR-II-138A", "BRD-K11533227","PF-184","CIL56", "AT7867","NVP-BEZ235", "trametinib","TG-101348", "valdecoxib","procarbazine", "ciclopirox","BMS-754807", "BMS-345541","dinaciclib", "BRD-K13999467", "BRD-K14844214","R428","gemcitabine", "NVP-ADW742","PRIMA-1", "phloretin","obatoclax", "BRD-K16147474","CHIR-99021", "PLX-4720","regorafenib", "sotrastaurin","BRD-K17060750", "bendamustine","SCH-79797", "HLI 373","indisulam", "belinostat","staurosporine", "birinapant","MK-0752", "BRD-K19103580","gossypol", "prochlorperazine", "sitagliptin","SGX-523", "saracatinib","lapatinib", "erismodegib","MST-312","CIL70", "tamatinib","SKI-II","KW-2449", "RO4929097","simvastatin", "STF-31","BRD8899", "CR-1-31B","1S-3R-RSL-3", "sorafenib","piperlongumine", "SCH-529074","ETP-46464", "BRD-K24690302","FSC231", "fluorouracil","KU-55933", "OSI-930","CD-1530", "austocystin D","BRD-K26531177", "PD 153035","cytochalasin B", "BIX-01294","BRD-K27224038", "leptomycin B", "lomeguatrib","BRD-K27986637","TW-37", "AZD4547","brivanib", "BRD-K28456706","CD-437", "BRD-K29086754","BRD-K29313308", "PIK-93","chlorambucil", "NSC30930","axitinib", "KX2-391","BRD-K30019337", "Compound 1541A","BRD-K30748066", "VU0155056","ceranib-2", "VER-155008","AGK-2", "cytarabine hydrochloride", "BRD-K33199242","tivantinib", "BRD-K33514849", "isoliquiritigenin","clofarabine", "BRD-K34099515","cimetidine", "BRD-K34222889", "BRD-K34485477","BMS-536924","FQI-2", "dacarbazine", "BRD-K35604418","ouabain","BRD6340", "darinaparsin","niclosamide", "KU-60019","I-BET151", "StemRegenin 1","NPC-26", "BRD-K37390332","SB-525334", "PF-3758309","etoposide", "LY-2183240","nakiterpiosin", "ML031","NSC19630", "lenvatinib","NSC 74859", "BRD-K41334119","BRD-K41597374", "palmostatin B", "BRD-K42260513","sunitinib","myricetin", "SNS-032","MLN2480", "PF-4800567 hydrochloride", "WP1130","BRD-K44224150", "ML083","pandacostat","ELCPK", "betulinic acid", "BRD-K45681478","NSC48300","IU1", "BMS-195614","CIL55","Ki8751", "GMX-1778","Repligen 136", "SR1001","BRD-K48334597", "BRD-K48477130", "nintedanib","GSK2636771", "BRD-K49290616","dasatinib", "PRIMA-1-Met","abiraterone", "sildenafil","NVP-TAE684", "necrostatin-7","canertinib", "HBX-41108","BRD-K50799972", "BRD-K51490254", "cabozantinib","TPCA-1","CAY10576", "BRD-K51831558", "BRD-K52037352","cerulenin", "tacedinaline","methylstat","AZD7545", "GDC-0941","JW-55", "tivozanib","BEC","SRT-1720", "neuronal differentiation inducer III","ruxolitinib", "MK-1775","JQ-1", "WAY-362450","BYL-719", "BRD-K55116708","SZ4TA2","rigosertib", "isonicotinohydroxamic acid", "epigallocatechin-3-monogallate","topotecan", "MGCD-265","ABT-737","vemurafenib", "selumetinib", "marinopyrrole A","AT13387", "daporinad","AZD6482","AZ-3146", "DBeQ","tozasertib", "bardoxolone methyl","methotrexate", "mitomycin","ML029", "serdemetan","MG-132","PYR-41", "CAL-101","Mdivi-1", "BRD-K61166597","SB-225002", "CAY10594","Compound 7d-cis", "SB-743921","ABT-199", "neopeltolide","BRD1835", "BRD-K70511574","tipifarnib-P2", "ZSTK474","tipifarnib-P1", "BRD-K63431240", "barasertib","gefitinib", "necrosulfonamide","MI-1","apicidin", "BRD-K64610608", "tretinoin","Ko-143","TG-100-115", "PHA-793887","BI-2536", "semagacestat","AZD1480", "afatinib","KH-CB19", "BRD-K66453893","BRD-K66532283", "pifithrin-alpha", "Compound 23 citrate","SB-431542", "KU-0063794","GDC-0879", "pevonedistat","PI-103", "MK-2206","NSC95397","BRD8958", "alvocidib","tacrolimus", "ISOX","AZD8055","CIL55A", "ibrutinib","erlotinib", "ML312","masitinib","SNX-2112", "KPT185","Ch-55", "N9-isopropylolomoucine", "BRD-K71781559","BRD5468", "QW-BI-011","WZ4002","BRD1812", "purmorphamine","BIRB-796", "curcumin","UNC0321", "NSC632839","pazopanib", "BRD-K75293299","alisertib","XL765", "IC-87114","JW-74", "omacetaxine mepesuccinate", "YM-155","A-804598","EX-527", "vandetanib","entinostat", "LY-2157299","crizotinib", "BRD-K78574327", "manumycin A","MLN2238","GSK4112", "KHS101","PF-573228", "decitabine","PF-543", "BRD-K80183349","ML203","etomoxir", "vorinostat","silmitasertib", "tanespimycin","ML320", "nilotinib","parthenolide", "WZ8040","vincristine", "navitoclax","PF-750", "CAY10618","PL-DI","skepinone-L", "nelarabine","CBB-1007", "BRD-K84807411","sirolimus", "spautin-1", "BRD-K85133207","neratinib","AZD7762", "BRD-K86535717","BRD4132", "bafilomycin A1","UNC0638", "cediranib","OSI-027", "veliparib","L-685458", "momelotinib","istradefylline", "fingolimod","bortezomib", "CI-976","BRD-K88742110", "tandutinib","BRD9876", "RG-108","ML006", "trifluoperazine","BRD-K90370028", "GW-843682X","pitstop2", "bosutinib","MI-2", "O-6-benzylguanine","doxorubicin", "tosedostat","GSK461364", "bexarotene","imatinib", "BRD-K92856060","SMER-3","PAC-1", "SJ-172550","RAF265", "AC55649","ML334 diastereomer", "vorapaxar","tamoxifen", "quizartinib","CHM-1","BRD1378", "VAF-347","BRD-K96431673", "pifithrin-mu", "BRD-K96970199","BRD-K97651142", "GSK-J4", "16-beta-bromoandrosterone","pluripotin", "BRD-K99006945","JW-480", "linifanib","BRD-M00053801"),
    MOA = c("inhibitor of MCL1", "inhibitor of DNA methyltransferases", "inhibitor of histone methyltransferases", "inhibitor of importin", "antagonist of Rev-ErbAalpha", "agonist of vitamin D receptor", "putative inhibitor of IDH1 R132H", "inhibitor of microtubule assembly","DNA alkylator", "binder of nuclear receptor SHP", "inhibitor of p53-MDM2 interaction", "inhibitor of ceramide kinase", "natural product; inhibitor of RNA polymerase II", "natural product", "inhibitor of BAX-mediated mitochondrial cytochrome c release", "inhibitor of WNT signaling by blocking beta-catenin transcription", "modulator of voltage-dependent anion channels; inhibitor of solute carrier SLC7A11", "natural product; modulator of NFKB1 and STAT3 signaling", "inhibitor of microtubule assembly", "agonist of calcium-permeable ion channels", "modulator of ADP-ribosylation factor 1; inhibitor of protein translocation from ER to Golgi", "analog of tetracycline", "anti-fungal agent; inhibitor of hedgehog signaling pathway", "agonist of glucocorticoid receptor", "inhibitor of topoisomerase II", "selectively kills engineered cells expressing mutant HRAS", "inhibitor of receptor-interacting protein kinase 1; inhibitor of the necroptosis cell death pathway", "metabolite of irinotecan; inhibitor of topoisomerase I", "inhibitor of calcineurin by binding to cyclophilin D", "inhibitor of PI3K catalytic subunit beta", "inducer of DNA damage", "screening hit", "inhibitor of glutaminase", "inhibitor of HMG-CoA reductase", "inhibitor of thioredoxin-1", "inhibitor of MEK1 and MEK2", "analog of tetracycline", "inhibitor of RNA helicase A (RHA) binding to EWS-FLI1; inhibitor of ERG and ETV1 activity", "inhibitor of ceramide synthase", "DNA alkylator", "inhibitor of sirtuin 1 and sirtuin 2", "\\inhibitor of BCL2, BCL-xL, and MCL1\\\"\"", "natural product", "inhibitor of HMG-CoA reductase", "putative inhibitor of IDH1 R132H", "inhibitor of myosin II ATPases", "inhibitor of serine palmitoyltransferase", "inhibitor of the interaction of urokinase receptor with binding partners", "inhibitor of RAC1-GEF interaction; prevents Rac1 activation by Rac-specific guanine nucleotide exchange factors (GEFs) TrioN and Tiam1", "inhibitor of mitochondrial ATP synthase", "inhibitor of BIM-BCL-B interaction","antagonist of GPR30", "antagonist of the estrogen receptor","screening hit", "modulator of KLF5 expression", "inhibitor of LSF1-mediated transcription", "immunomodulatory drug; binder of cereblon","DNA alkylator", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of MAP3K8; inhibitor of phosphorylated EGFR in cells", "inhibitor of p53-MDM2 interaction", "inhibitor of tubulin deacetylase activity of HDAC6", "ML239; inhibitor of breast cancer stem cell proliferation", "inhibitor of leucine-rich repeat kinase 2; inhibitor of doublecortin-like kinase", "inhibitor of Jun N-terminal kinase (JNK) 1/2/3", "screening hit", "selectively kills engineered cells expressing mutant HRAS", "inhibitor of Janus kinase 2", "inhibitor of poly (ADP-ribose) polymerase 1 and 2", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "product of diversity oriented synthesis", "inhibitor of microtubule assembly", "product of diversity oriented synthesis", "inhibitor of GTPase activating protein of ARF 1 (ARFGAP1)", "SMAC mimetic; inhibitor of inhibitor of apoptosis proteins (IAPs)", "inhibitor of MET", "inhibitor of cation channel TRPV4", "inhibitor of DNA methyltransferase", "inhibitor of MET and VEGFR2", "inhibitor of HDAC1 and HDAC2", "inhibitor of telomerase reverse transcriptase", "product of diversity oriented synthesis", "antagonist of retinoic acid receptor gamma", "inhibitor of JAK/STAT signaling", "screening hit", "inhibitor of phosphdiesterase 4A/B/D", "screening hit", "inhibitor of ceramide glucosyltransferase", "antagonist of retinoic acid receptor beta", "inhibitor of PI3K and mTOR kinase activity", "activates cellular activity of RhoA; modulator of Rho/Rho kinase/LIM kinase/cofilin signaling", "agonist of retinoic acid receptor alpha", "inhibitor of cytosolic phospholipase A2; inhibitor of fatty acid amide hydrolase", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "inhibitor of mTOR", "inhibitor of cathepsin L", "inhibitor of insulin-like growth factor 1 receptor and insulin receptor", "inhibitor of glucosylceramide synthase; activator of MAP kinase (ERK); stimulator of protein phosphatase 2A","screening hit", "inhibitor of hedgehog signaling pathway", "inhibitor of DNA-dependent protein kinase", "product of diversity oriented synthesis", "activator of peripheral benzodiazepine receptor/translocator protein", "inhibitor of phosphatase of regenerating liver-3 (PRL3)","inhibitor of BRAF", "natural product; inhibitor of nucleophosmin", "partial agonist of cannabinoid receptor 2","inhibitor of RAD51", "silvestrol analog; inhibits translation by modulating the eIF4F complex", "inhibitor of HDAC1 and HDAC2", "inhibitor of IKK-2", "screening hit", "inhibitor of AKT1/2/3 and S6K", "inhibitor of PI3K and mTOR kinase activity", "inhibitor of MEK1 and MEK2", "inhibitor of Janus kinase 2", "inhibitor of cyclooxygenase-2 (COX2)", "inducer of DNA damage", "substituted pyridone antimycotic; inhibitor of the iron-dependent enzyme ribonucleotide reductase", "inhibitor of insulin-like growth factor 1 receptor and insulin receptor", "inhibitor of IKK-2", "inhibitor of cyclin-dependent kinases", "product of diversity oriented synthesis", "product of diversity oriented synthesis", "inhibitor of the tyrosine-protein kinase receptor UFO", "\\inhibitor of DNA replication; inhibitor of ribonucleotide reductase, thymidylate synthetase, and cytidine monophosphate (UMP-CMP) kinase \\\"\"", "inhibitor of insulin-like growth factor 1 receptor", "re-activator of the pro-apoptotic activity of mutant p53", "natural product; inhibitor of glucose uptake", "\\inhibitor of MCL1, BCL2, and BCL-xL\\\"\"", "product of diversity oriented synthesis", "inhibitor of GSK3 beta", "inhibitor of BRAF", "\\inhibitor of BRAF, RET, KIT, and VEGFR2\\\"\"", "inhibitor of protein kinase C beta", "product of diversity oriented synthesis", "DNA alkylator", "antagonist of proteinase-activated receptor 1 (PAR1)", "inhibitor of MDM2", "inhibitor of carbonic anhydrase isoform IX", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of multiple kinases", "SMAC mimetic; inhibitor of inhibitor of apoptosis proteins (IAPs)", "inhibitor of gamma-secretase", "product of diversity oriented synthesis", "inhibitor of lactate dehydrogenase; inhibitor of BCL2 family members", "inhibitor of dopamine receptor D2", "inhibitor of dipetidyl peptidase-4", "inhibitor of MET", "inhibitor of SRC and ABL1", "inhibitor of EGFR and HER2", "screening hit", "inhibitor of telomerase reverse transcriptase", "screening hit", "inhibitor of spleen tyrosine kinase", "inhibitor of sphingosine kinase 1", "inhibitor of FLT3 and AURKA", "inhibitor of gamma-secretase", "inhibitor of HMG-CoA reductase", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of serine/threonine kinasase STK33", "silvestrol analog; inhibits translation by modulating the eIF4F complex", "synthetic lethal with HRAS in engineered cells; inhibitor of GPX4", "\\inhibitor of BRAF, CRAF, and VEGFR2\\\"\"", "natural product; modulator of ROS levels", "activator of mutant p53", "inhibitor of serine/threonine-protein kinase ATR", "inhibitor of HDAC1", "inhibitor of PDZ domain of protein interacting with PRKCA 1 (PICK1)", "pyrimidine analog; inhibitor of thymidylate synthase", "inhibitor of ataxia telangiectasia mutated (ATM)", "inhibitor of c-KIT and VEGFR2", "agonist of retinoic acid receptor gamma", "natural product; inducer of DNA damage", "analog of the natural product piperlongumine", "inhibitor of EGFR", "inhibitor of actin polymerization", "inhibitor of G9a histone methyltransferase", "product of diversity oriented synthesis", "inhibitor of exportin 1", "inhibitor of methylguanine-DNA methyltransferase", "product of diversity oriented synthesis; screening hit", "inhibitor of BCL2 and BCL-xL", "inhibitor of fibroblast growth factor receptors", "inhibitor of VEGFR 1/2", "inhibitor of hepatocyte nuclear factor 4 alpha", "agonist of retinoic acid receptor gamma", "product of diversity oriented synthesis", "inhibitor of HDAC3", "inhibitor of PI3K catalytic subunit gamma", "DNA alkylator", "inhibitor of steroid 5-alpha reductase", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "peptide mimetic; inhibitor of SRC activity in cells", "product of diversity oriented synthesis", "\\activators of executioner procaspases 3, 6, and 7\\\"\"", "inhibitor of CDK9", "inhibitor of phospholipase D1/D2", "inhibitor of ceramidase activity", "inhibitor of HSP70","inhibitor of sirtuin 2", "inducer of DNA damage", "product of diversity oriented synthesis", "inhibitor of MET; inhibitor of microtubule assembly","screening hit", "natural product", "inducer of DNA damage", "screening hit", "inhibitor of histidine receptor H2", "analog of the natural product piperlongumine", "product of diversity oriented synthesis", "inhibitor of insulin-like growth factor 1 receptor (IGF1R) and insulin receptor (INSR)", "inhibitor of LSF1-mediated transcription", "DNA alkylator","inhibitor of MCL1", "cardiac glycoside; inhibitor of the Na+/K+-ATPase", "screening hit", "inducer of ROS; inhibitor of microtubule assembly", "inhibitor of STAT3 signaling", "inhibitor of ataxia telangiectasia mutated (ATM)", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "inhibitor of aryl hydrocarbon receptor", "\\induces cell death through a non-apoptotic, mitochondrial-dependent mechanism\\\"\"", "product of diversity oriented synthesis", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of serine/threonine p21-activating kinase 4", "inhibitor of topoisomerase II", "inhibitor of fatty acid amide hydrolase; inhibitor of anandamide uptake", "natural product; inhibitor of microtubule assembly", "inhibitor of sphingosine 1-phosphate receptor 2", "inhibitor of Werner syndrome helicase activity", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "inhibitor of STAT3", "product of diversity oriented synthesis", "product of diversity oriented synthesis", "inhibitor of acyl-protein thioesterase 1", "inhibitor of enhancer of zeste polycomb repressive complex 2 subunit", "\\inhibitor of VEGFRs, c-KIT, and PDGFR alpha and beta\\\"\"", "flavonoid antioxidant", "inhibitor of cyclin-dependent kinases", "inhibitor of RAF kinases", "inhibitor of casein kinase isoforms delta and epsilon", "\\inhibitor of the deubiquitinase activity of USP9X, USP5, USP14, and UCH37\\\"\"", "product of diversity oriented synthesis", "activator of muscle pyruvate kinase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"","screening hit", "natural product; inhibitor of specificity protein 1 transcription factor in cells", "product of diversity oriented synthesis; screening hit", "inhibitor of threonine endopeptidase taspase 1", "inhibitor of the deubiquitinase activity of USP14", "antagonist of retinoic acid receptors","screening hit", "\\inhibitor of VEGFR2, c-KIT, and PDGFRA\\\"\"", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of HDAC3", "synthetic ROR ligand; suppressor of TH17 differentiation", "product of diversity oriented synthesis", "screening hit", "\\inhibitor of c-KIT, VEGFRs, PDGFRs, and FGFRs\\\"\"", "inhibitor of PI3K catalytic subunit beta", "product of diversity oriented synthesis", "\\inhibitor of SRC, YES1, EPHA2, c-KIT, and LCK\\\"\"", "re-activator of the pro-apoptotic activity of mutant p53", "\\inhibitor of 17 alpha-hydroxylase and C17,20 lyase\\\"\"", "inhibitor of phosphodiesterase 5A", "inhibitor of ALK and ALK-NPM fusion protein", "inhibitor of necroptosis", "inhibitor of EGFR and HER2", "inhibitor of the deubiquitinase activity of USP7", "product of diversity oriented synthesis", "inhibitor of HDAC6 and HDAC8", "\\inhibitor of c-MET, VEGFR2/3, and RET\\\"\"", "inhibitor of IKK-2", "inhibitor of IKK-epsilon", "inhibitor of enhancer of zeste polycomb repressive complex 2 subunit", "product of diversity oriented synthesis", "inhibitor of fatty acid synthase; inhibitor of HMG-CoA synthase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of lysine specific demethylases", "inhibitor of pyruvate dehydrogenase kinase 2", "inhibitor of PI3K kinase activity", "inhibitor of tankyrase", "inhibitor of VEGFRs", "inhibitor of arginase I and II", "activator of sirtuin-1", "induction of rat HCN cell differentiation as judged by induction of neuronal reporter neuroD activity", "inhibitor of Janus kinases 1 and 2", "inhibitor of WEE1", "inhibitor of bromodomain (BRD) and extra-C terminal domain (BET) proteins", "agonist of farnesoid X receptor", "inhibitor of PI3K catalytic subunit alpha", "product of diversity oriented synthesis; inhibitor of leukemic stem cells", "inhibitor of BCL-xL", "inhibitor of polo-like kinase 1; inhibitor of PI3K catalytic subunits alpha and beta", "inhibitor of HDAC6", "natural product", "inhibitor of topoisomerase I", "inhibitor of c-MET and VEGFRs", "\\inhibitor of BCL2, BCL-xL, and BCL-W\\\"\"","inhibitor of BRAF", "inhibitor of MEK1 and MEK2", "natural product; putative inhibitor of MCL1", "inhibitor of HSP90", "inhibitor of nicotinamide phosphoribosyltransferase", "inhibitor of PI3K catalytic subunits beta and delta", "inhibitor of TTK protein kinase", "inhibitor of p97 in cells", "inhibitor of aurora kinases", "electrophilic inducer of the NFE2L2-KEAP1 pathway", "inhibitor of dihydrofolate reductase","DNA crosslinker", "inhibitor of antigen receptor-mediated NFkappaB activity", "inhibitor of MDM2", "inhibitor of the proteosome", "inhibitor of ubiquitin-activating enzyme in cells", "inhibitor of PI3K catalytic subunit delta", "inhibitor of dynamin 1; inhibitor of mitrochondrial division inhibitor", "inhibitor of HDAC1 and HDAC2", "inhibitor of chemokine receptor 2", "inhibitor of phospholipase D2", "inhibitor of CRM1-mediated nucleocytoplasmic transport", "inhibitor of kinesin 11", "inhibitor of BCL2", "inhibitor of cellular respiration", "product of diversity oriented synthesis; screening hit", "inhibitor of polo-like kinase 1 (PLK1)", "inhibitor of farnesyltransferase", "\\inhibitor of PI3K catalytic subunits beta, delta, and gamma\\\"\"", "inhibitor of farnesyltransferase", "product of diversity oriented synthesis; screening hit", "inhibitor of aurora kinase B", "inhibitor of EGFR and AKT1", "inhibitor of downstream signaling of RIP3 associated with MLKL", "binder of menin; inhibitor of menin-MLL fusion protein", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "product of diversity oriented synthesis; screening hit", "agonist of retinoid acid receptors", "inhibitor of breast cancer resistance protein multidrug transporter (BCRP)", "inhibitor of PI3K catalytic subunits delta and gamma", "inhibitor of cyclin-dependent kinases", "inhibitor of polo-like kinase 1 (PLK1)", "inhibitor of gamma-secretase", "inhibitor of Janus kinases 1 and 2", "inhibitor of EGFR and HER2", "inhibitor of CDC2-like kinases 1 and 4", "product of diversity oriented synthesis", "inhibitor of HDAC1 and HDAC2", "inhibitor of p53-dependent signaling", "analog of natural product cortistatin", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of mTOR","inhibitor of BRAF", "inhibitor of Nedd-8 activating enzyme", "\\inhibitor of DNA-PK, PI3K p110 delta, mTORC1, and catalytic subunits of PI3K\\\"\"", "inhibitor of AKT1", "inhibitor of cell division cycle 25 phosphatase (CDC25)", "inhibitor of E1A binding protein p300", "inhibitor of cyclin-dependent kinases", "inhibitor of calcineurin", "inhibitor of HDAC6","inhibitor of mTOR", "screening hit", "inhibitor of Bruton's tyrosine kinase", "inhibitor of EGFR and HER2", "\\inhibitor of scavenger receptor class B, member 1 (SCARB1)-mediated lipid uptake\\\"\"", "\\inhibitor of c-KIT, PDGFRA, and PDGFRB\\\"\"", "inhibitor of HSP90alpha and HSP90beta", "inhibitor of exportin 1", "agonist of retinoid acid receptors", "inhibitor of CDK1/cyclin B and CDK5/p35 complexes", "screening hit", "inducer of ROS", "inhibitor of G9a histone methyltransferase", "inhibitor of EGFR targeting T790M resistance", "screening hit", "activator of smoothened receptor", "inhibitor of p38 MAPK", "natural product; modulator of ROS; modulator of NF-kappa-B signaling", "inhibitor of G9a histone methyltransferase", "inhibitor of ubiquitin isopeptidase", "\\inhibitor of VEGFRs, c-KIT, and PDGFRB\\\"\"", "product of diversity oriented synthesis", "inhibitor of aurora kinases A and B", "inhibitor of mTOR and PI3K kinase acitivities", "inhibitor of PI3K catalytic subunit delta", "inhibitor of WNT signaling", "inhibitor of protein translation by preventing protein elongation", "inhibitor of survivin expression", "inhibitor of purinergic receptor P2X", "inhibitor of sirtuin 1", "inhibitor of VEGFR2 and EGFR", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of the transforming growth factor beta type 1 receptor", "inhibitor of c-MET and ALK", "product of diversity oriented synthesis", "inhibitor of RAS farnesyltransferase", "inhibitor of 20S proteasome at the chymotrypsin-like proteolytic (beta-5) site", "antagonist of Rev-ErbAalpha", "\\binder of TACC3, a component of the centrosome and mitotic spindle\\\"\"", "inhibitor of focal adhesion kinase", "inhibitor of DNA methyltransferase", "inhibitor of sphingosine kinase-1", "inhibitor of HDAC1 and HDAC2", "activator of muscle pyruvate kinase (PKM2)", "inhibitor of carnitine palmitoyltransferase", "\\inhibitor of HDAC1, HDAC2, HDAC3, HDAC6, and HDAC8\\\"\"", "inhibitor of casein kinase 2", "inhibitor of HSP90", "inhibitor of GSK3 beta", "\\inhibitor of ABL1, BCR, and c-KIT\\\"\"", "natural product; modulator of ROS; modulator of NF-kappa-B signaling", "inhibitor of EGFR targeting T790M resistance", "inhibitor of mictrotubule assembly", "\\inhibitor of BCL2, BCL-xL, and BCL-W\\\"\"", "inhibitor of fatty acid amide hydrolase", "inhibitor of nicotinamide phosphoribosyltransferase", "dimer of piperlongumine; inducer of ROS", "inhibitor of p38 MAPK", "deoxyguanosine analog; inhibitor of DNA synthesis", "inhibitor of lysine-specific demethylase 1A (LSD1)", "product of diversity oriented synthesis", "inhibitor of mTOR", "inhibitor of the deubiquitinase activity of USP13 and USP10", "inhibitor of HDAC1", "inhibitor of EGFR and HER2", "inhibitor of checkpoint kinases 1 and 2", "product of diversity oriented synthesis", "screening hit", "inhibitor of the vacuolar-type H+-ATPase", "inhibitor of EHMT2 and GLP methyltransferase", "inhibitor of VEGFRs", "inhibitor of mTORC1 and mTORC2", "inhibitor of poly (ADP-ribose) polymerase 1 (PARP1) and 2 (PARP2)", "inhibitor of gamma-secretase", "inhibitor of Janus kinases 1 and 2", "antagonist of the adenosine A2A receptor", "inhibitor of sphingosine 1-phosphate receptor", "inhibitor of 26S proteasome", "inhibitor of acetyl-CoA acetyltransferase I", "inhibitor of HDAC8", "inhibitor of c-KIT and VEGFR3", "screening hit", "inhibitor of DNA methyltransferase", "agonist of sphingosine 1-phosphate receptor 3", "antagonist of dopamine receptor D2", "screening hit", "inhibitor of PLK1 and PLK3", "inhibitor of clathrin and clathrin-independent endocytosis", "inhibitor of SRC and ABL1", "binder of menin; inhibitor of menin-MLL fusion protein", "inhibitor of O(6)-alkylguanine DNA alkyltransferases", "inhibitor of topoisomerase II", "\\inhibitor of leucine aminopeptidase 3 (LAP), puromycin-sensitive aminopeptidase (PuSA), and aminopeptidase N\\\"\"", "inhibitor of polo-like kinase 1 (PLK1)", "agonist of retinoid X receptors", "inhibitor of BCR-ABL1 and c-KIT", "screening hit", "inhibitor of E3-ubiquitin ligase", "activator of procaspase-3", "inhibitor of p53-MDM2 interaction", "ihibitor of VEGFR2 and BRAF", "agonist of retinoic acid receptor beta", "inhibitor of KEAP1-NFE2L2 protein-protein interaction", "antagonist of proteinase-activated receptor 1 (PAR1)", "modulator of estrogen receptors","inhibtor of VEGFR3", "inhibitor of tubulin polymerization","inducer of ROS", "inhibitor of aryl hydrocarbon receptor", "product of diversity oriented synthesis", "inhibitor of p53 binding to mitochondria; inhibitor of HSP70", "product of diversity oriented synthesis", "aphrocallistin derivative", "inhibitor of lysine-specific demethylases", "dehydroepiandrosterone (DHEA) analog", "promoter of embryonic stem cell self-renewal; inhibitor of Ras-GAP and ERK", "screening hit", "inhibitor of serine hydrolase enzyme NCEH", "inhibitor of VEGFRs", "inhibitor of BCL2"),
    CLINICAL.STATUS = c("Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Clinical trial","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "Clinical trial","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","FDA approved","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Clinical trial", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Clinical trial","Under investigation", "Clinical trial","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation", "Clinical trial","Under investigation", "FDA approved","FDA approved","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Clinical trial","Under investigation", "Under investigation","FDA approved","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","FDA approved", "Clinical trial","Under investigation","Under investigation", "FDA approved", "Clinical trial","Under investigation","FDA approved","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation", "Clinical trial","Under investigation","FDA approved","Under investigation", "Under investigation","FDA approved", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Clinical trial", "Clinical trial","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "FDA approved","Under investigation", "Clinical trial","FDA approved", "Under investigation","Under investigation","Under investigation","FDA approved", "Under investigation","Under investigation","Under investigation","Under investigation", "Clinical trial","Under investigation","Under investigation","Under investigation", "FDA approved","Clinical trial","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation", "Under investigation","Under investigation","Under investigation","Under investigation","Under investigation","Under investigation")  )

  merged.table = dplyr::left_join(merged.table, drug.annotation.20220409, by=c("Drug"="NAME"))


  print("Pls note, differential analysis didn't consider sensitivity direction\n")
  print("Pls also note, we converted AUC to 1-AUC since lower IC50 is sensitive\n")

  res = list(
    AUC = drug.auc.analysis.res,
    Sig = drug.sig.analysis.res,
    Merged = merged.table
  )

  res
}






#' Calculate IC50 based on oncoPredict
#'
#' @param train.df path or readRDS("DataFiles/Training Data/CTRP2_Expr (TPM, not log transformed).rds")
#' @param train.res readRDS("DataFiles/Training Data/CTRP2_Res.rds")
#' @param predict.df
#' @param minNumSamples
#'
#' @return
#' @export
#'
#' @examples
oncoPredict <- function(train.df=NULL, train.res = NULL, predict.df = NULL, minNumSamples = 10){

  # https://www.cancer.org/cancer/esophagus-cancer/treating/chemotherapy.html

  if(is.vector(train.df)){
    train.df = readRDS(train.df)
  }


  if(is.null(train.df)| is.null(train.res)){
    stop("Pls down load training data from https://osf.io/c6tfx/ Ref: https://github.com/maese005/oncoPredict")
  }
  warning("Pls check log2 transformation")

  library(oncoPredict)

  calcPhenotype(trainingExprData = train.df,
                trainingPtype = train.res,
                testExprData = predict.df,
                batchCorrect = 'eb',  #   "eb" for ComBat
                powerTransformPhenotype = TRUE,
                removeLowVaryingGenes = 0.2,
                minNumSamples = minNumSamples,
                printOutput = TRUE,
                removeLowVaringGenesFrom = 'rawData' )

}




